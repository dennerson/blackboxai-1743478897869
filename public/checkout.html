<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - SpendMore</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles/main.css">
</head>
<body class="font-roboto bg-gray-50">
    <!-- Header (same as index.html) -->
    <header class="bg-orange-500 text-white shadow-md">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <a href="/" class="text-2xl font-bold">SpendMore</a>
                <div class="relative w-96">
                    <input type="text" placeholder="Search for products..." 
                           class="w-full py-2 px-4 rounded text-gray-800 focus:outline-none">
                    <button class="absolute right-0 top-0 h-full px-4 bg-orange-600 rounded-r">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
            <nav class="flex items-center space-x-6">
                <a href="/auth.html" class="hover:underline"><i class="fas fa-user mr-1"></i> Login</a>
                <a href="/cart.html" class="hover:underline"><i class="fas fa-shopping-cart mr-1"></i> Cart</a>
            </nav>
        </div>
    </header>

    <!-- Checkout Progress -->
    <div class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-center">
                <div class="flex items-center">
                    <div class="flex flex-col items-center mr-8">
                        <div class="w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center mb-1">1</div>
                        <span class="text-sm font-medium">Shipping</span>
                    </div>
                    <div class="h-1 w-16 bg-gray-200"></div>
                    <div class="flex flex-col items-center mx-8">
                        <div class="w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center mb-1">2</div>
                        <span class="text-sm text-gray-500">Payment</span>
                    </div>
                    <div class="h-1 w-16 bg-gray-200"></div>
                    <div class="flex flex-col items-center ml-8">
                        <div class="w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center mb-1">3</div>
                        <span class="text-sm text-gray-500">Review</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Section -->
    <main class="container mx-auto px-4 py-8">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Shipping Form -->
            <div class="lg:w-2/3">
                <div class="bg-white p-6 rounded-lg shadow-sm mb-6">
                    <h2 class="text-xl font-bold mb-6">Shipping Information</h2>
                    
                    <form id="shipping-form">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="first-name" class="block mb-1">First Name</label>
                                <input type="text" id="first-name" class="input-field" required>
                            </div>
                            <div>
                                <label for="last-name" class="block mb-1">Last Name</label>
                                <input type="text" id="last-name" class="input-field" required>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="address" class="block mb-1">Address</label>
                            <input type="text" id="address" class="input-field" required>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label for="city" class="block mb-1">City</label>
                                <input type="text" id="city" class="input-field" required>
                            </div>
                            <div>
                                <label for="state" class="block mb-1">State/Province</label>
                                <input type="text" id="state" class="input-field" required>
                            </div>
                            <div>
                                <label for="zip" class="block mb-1">ZIP/Postal Code</label>
                                <input type="text" id="zip" class="input-field" required>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="country" class="block mb-1">Country</label>
                            <select id="country" class="input-field" required>
                                <option value="">Select Country</option>
                                <option value="US">United States</option>
                                <option value="UK">United Kingdom</option>
                                <option value="CA">Canada</option>
                                <option value="AU">Australia</option>
                                <option value="SG">Singapore</option>
                                <option value="MY">Malaysia</option>
                                <option value="PH">Philippines</option>
                                <option value="TH">Thailand</option>
                                <option value="VN">Vietnam</option>
                                <option value="ID">Indonesia</option>
                            </select>
                        </div>
                        
                        <div class="mb-4">
                            <label for="phone" class="block mb-1">Phone Number</label>
                            <input type="tel" id="phone" class="input-field" required>
                        </div>
                        
                        <div class="mb-4">
                            <label for="email" class="block mb-1">Email Address</label>
                            <input type="email" id="email" class="input-field" required>
                        </div>
                        
                        <div class="flex items-center mb-6">
                            <input type="checkbox" id="save-address" class="mr-2">
                            <label for="save-address">Save this address for future use</label>
                        </div>
                    </form>
                </div>
                
                <!-- Payment Method -->
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <h2 class="text-xl font-bold mb-6">Payment Method</h2>
                    
                    <div class="space-y-4">
                        <div class="flex items-center border border-gray-200 rounded-lg p-4">
                            <input type="radio" id="credit-card" name="payment" class="mr-3" checked>
                            <label for="credit-card" class="flex-1">
                                <div class="font-medium">Credit/Debit Card</div>
                                <div class="flex space-x-2 mt-1">
                                    <img src="https://cdn-icons-png.flaticon.com/512/196/196578.png" alt="Visa" class="h-6">
                                    <img src="https://cdn-icons-png.flaticon.com/512/196/196561.png" alt="Mastercard" class="h-6">
                                </div>
                            </label>
                        </div>
                        
                        <div class="flex items-center border border-gray-200 rounded-lg p-4">
                            <input type="radio" id="paypal" name="payment" class="mr-3">
                            <label for="paypal" class="flex-1">
                                <div class="font-medium">PayPal</div>
                                <img src="https://cdn-icons-png.flaticon.com/512/174/174861.png" alt="PayPal" class="h-6 mt-1">
                            </label>
                        </div>
                        
                        <div class="flex items-center border border-gray-200 rounded-lg p-4">
                            <input type="radio" id="cod" name="payment" class="mr-3">
                            <label for="cod" class="flex-1">
                                <div class="font-medium">Cash on Delivery (COD)</div>
                                <div class="text-sm text-gray-500 mt-1">Pay when you receive your order</div>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Credit Card Form (shown when credit card is selected) -->
                    <div id="credit-card-form" class="mt-6 p-4 border border-gray-200 rounded-lg">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="card-number" class="block mb-1">Card Number</label>
                                <input type="text" id="card-number" placeholder="1234 5678 9012 3456" class="input-field">
                            </div>
                            <div>
                                <label for="card-name" class="block mb-1">Name on Card</label>
                                <input type="text" id="card-name" class="input-field">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                            <div>
                                <label for="exp-month" class="block mb-1">Expiry Month</label>
                                <select id="exp-month" class="input-field">
                                    <option value="">Month</option>
                                    <option value="01">01 - January</option>
                                    <option value="02">02 - February</option>
                                    <!-- Other months -->
                                </select>
                            </div>
                            <div>
                                <label for="exp-year" class="block mb-1">Expiry Year</label>
                                <select id="exp-year" class="input-field">
                                    <option value="">Year</option>
                                    <option value="2023">2023</option>
                                    <option value="2024">2024</option>
                                    <!-- Next 5 years -->
                                </select>
                            </div>
                            <div>
                                <label for="cvv" class="block mb-1">CVV</label>
                                <input type="text" id="cvv" placeholder="123" class="input-field">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Order Summary -->
            <div class="lg:w-1/3">
                <div class="bg-white p-6 rounded-lg shadow-sm sticky top-4">
                    <h2 class="text-xl font-bold mb-4">Order Summary</h2>
                    
                    <div class="border-b border-gray-200 pb-4 mb-4">
                        <div class="flex justify-between mb-2">
                            <span>Subtotal</span>
                            <span id="checkout-subtotal">$0.00</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span>Shipping</span>
                            <span id="checkout-shipping">$0.00</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span>Tax</span>
                            <span id="checkout-tax">$0.00</span>
                        </div>
                        <div class="flex justify-between font-bold text-lg">
                            <span>Total</span>
                            <span id="checkout-total">$0.00</span>
                        </div>
                    </div>
                    
                    <!-- Order Items -->
                    <div class="mb-6">
                        <h3 class="font-medium mb-2">Your Items</h3>
                        <div id="checkout-items" class="space-y-3">
                            <!-- Items will be loaded via JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Promo Code -->
                    <div class="mb-6">
                        <label for="checkout-coupon" class="block mb-1">Promo Code</label>
                        <div class="flex">
                            <input type="text" id="checkout-coupon" class="input-field rounded-r-none" value="SpendMore10">
                            <button id="apply-checkout-coupon" class="bg-gray-200 px-4 py-2 rounded-r hover:bg-gray-300 transition">Apply</button>
                        </div>
                    </div>
                    
                    <!-- Place Order Button -->
                    <button id="place-order" class="btn-primary w-full py-3">
                        Place Order
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer (same as index.html) -->
    <footer class="bg-gray-800 text-white py-12">
        <!-- Footer content -->
    </footer>

    <script src="/scripts/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load order summary
            updateCheckoutSummary();
            
            // Show/hide credit card form based on payment method
            document.querySelectorAll('input[name="payment"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    document.getElementById('credit-card-form').style.display = 
                        e.target.id === 'credit-card' ? 'block' : 'none';
                });
            });
            
            // Apply coupon button
            document.getElementById('apply-checkout-coupon').addEventListener('click', () => {
                const coupon = document.getElementById('checkout-coupon').value;
                if (coupon === 'SPENDMORE10') {
                    alert('10% discount applied!');
                    // In a real app, you would update the totals here
                } else {
                    alert('Invalid coupon code');
                }
            });
            
            // Place order button
            document.getElementById('place-order').addEventListener('click', () => {
                if (validateForm()) {
                    // In a real app, you would process the payment here
                    alert('Order placed successfully!');
                    // Clear cart and redirect to order confirmation
                    localStorage.removeItem('cart');
                    window.location.href = '/order-confirmation.html';
                }
            });
        });

        function updateCheckoutSummary() {
            if (cart.length === 0) {
                window.location.href = '/cart.html';
                return;
            }

            const subtotal = cart.reduce((sum, item) => {
                const product = products.find(p => p.id === item.id);
                return sum + (product.price * item.quantity);
            }, 0);

            const shipping = subtotal > 50 ? 0 : 5.99;
            const tax = subtotal * 0.08;
            const total = subtotal + shipping + tax;
            
            document.getElementById('checkout-subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('checkout-shipping').textContent = shipping === 0 ? 'FREE' : `$${shipping.toFixed(2)}`;
            document.getElementById('checkout-tax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('checkout-total').textContent = `$${total.toFixed(2)}`;
            
            // Render order items
            const itemsContainer = document.getElementById('checkout-items');
            itemsContainer.innerHTML = '';
            
            cart.forEach(item => {
                const product = products.find(p => p.id === item.id);
                itemsContainer.innerHTML += `
                    <div class="flex items-center">
                        <img src="${product.image}" alt="${product.name}" class="w-12 h-12 object-contain mr-3">
                        <div class="flex-1">
                            <div class="text-sm">${product.name}</div>
                            <div class="text-xs text-gray-500">Qty: ${item.quantity}</div>
                        </div>
                        <div class="text-sm font-medium">$${(product.price * item.quantity).toFixed(2)}</div>
                    </div>
                `;
            });
        }

        function validateForm() {
            const requiredFields = [
                'first-name', 'last-name', 'address', 'city', 
                'state', 'zip', 'country', 'phone', 'email'
            ];
            
            let isValid = true;
            
            requiredFields.forEach(id => {
                const field = document.getElementById(id);
                if (!field.value.trim()) {
                    field.classList.add('border-red-500');
                    isValid = false;
                } else {
                    field.classList.remove('border-red-500');
                }
            });
            
            // Validate credit card if selected
            if (document.getElementById('credit-card').checked) {
                const cardFields = ['card-number', 'card-name', 'exp-month', 'exp-year', 'cvv'];
                cardFields.forEach(id => {
                    const field = document.getElementById(id);
                    if (!field.value.trim()) {
                        field.classList.add('border-red-500');
                        isValid = false;
                    } else {
                        field.classList.remove('border-red-500');
                    }
                });
            }
            
            if (!isValid) {
                alert('Please fill in all required fields');
                return false;
            }
            
            return true;
        }
    </script>
</body>
</html>